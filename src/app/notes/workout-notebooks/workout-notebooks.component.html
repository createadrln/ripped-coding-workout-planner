<!--ToDo Allow Change Workout Row Order-->

<header class="workout-notebooks__header">
    <div class="mx-3 mx-sm-5 my-4 my-sm-0 mt-sm-5 mb-sm-3 pb-3 border-bottom border-dark clearfix">
        <h1 class="h5 float-sm-left">My Workout Notebooks</h1>
        <div class="btn btn-link text-success float-sm-right p-0" (click)="openLargeModal(new_workout_modal)">
            <mat-icon class="align-middle mr-1">description</mat-icon>
            <span class="align-middle">Add New Notebook</span>
        </div>
    </div>
</header>

<section>
    <div class="workout-notebooks px-1 px-sm-5 mb-3 mb-sm-5">
        <div class="workout-notebooks__search col-sm-3 mb-3">
            <input [(ngModel)]="searchText" type="text" class="form-control" placeholder="Search Workout Notebooks">
        </div>
        <div *ngFor="let notebook of workoutNotebooks | async | reverse | filter: { title: searchText }; let i = index"
             class="workout-notebooks-row row p-4">
            <div class="col-12">
                <div class="d-inline-block w-75 align-top">
                    <h3 class="h5">{{ notebook.title }}</h3>
                    <p class="m-0">
                        <em *ngFor="let tag of notebook.tags" class="mr-2">{{ tag.display }}</em>
                    </p>
                </div>
                <div class="d-inline-block w-25 align-top text-right workout-notebooks__current-status">
                    <mat-icon *ngIf="notebook.current === true" class="text-success">
                        check_circle_outline
                    </mat-icon>
                    <mat-icon *ngIf="!notebook.current" class="text-medium-gray show-hover"
                              (click)="openWarningModal(current_notebook_modal)">
                        check_circle_outline
                    </mat-icon>
                    <!-- Set Current Notebook Alert -->
                    <ng-template #current_notebook_modal let-modal>
                        <div class="modal-header">
                            <h4 class="modal-title">Set Current</h4>
                            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss()">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <p>Do you want to make this your current workout?</p>
                            <div (click)="setCurrentWorkout(notebook.key)" class="btn btn-secondary">Yes, Do It</div>
                            <div (click)="modal.dismiss()" class="btn btn-dark ml-1">Cancel</div>
                        </div>
                    </ng-template>
                </div>
                <div class="row">
                    <div class="col-12 mt-4">
                        <div *ngFor="let workout of notebook.workouts">
                            <ul *ngFor="let note of notes | async | key:workout.selected" class="list-group shadow">
                                <li class="list-group-item">
                                    <div class="clearfix py-1">
                                        <span class="d-inline-block w-75"><strong>{{ note.title }}</strong></span>
                                        <mat-icon [hidden]="hideWorkoutExercises[note.key]" class="float-right show-hover"
                                                  (click)="hideWorkoutExercises[note.key] = !hideWorkoutExercises[note.key]">
                                            arrow_drop_down_circle
                                        </mat-icon>
                                        <mat-icon [hidden]="!hideWorkoutExercises[note.key]" class="float-right show-hover"
                                                  (click)="hideWorkoutExercises[note.key] = !hideWorkoutExercises[note.key]">
                                            cancel
                                        </mat-icon>
                                    </div>
                                    <div [hidden]="!hideWorkoutExercises[note.key]">
                                        <ul *ngFor="let exercise of note.exercises" class="list-group list-group-flush">
                                            <li class="list-group-item border-bottom-0 px-0">
                                                <strong>{{ exercise.title }}:</strong> Sets: {{ exercise.sets }} | Reps: {{
                                                exercise.reps}} | {{ exercise.weight }}
                                            </li>
                                        </ul>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="workout-notebook-actions mt-4">
                    <div (click)="openWarningModal(delete_notebook_modal)"
                         class="btn btn-secondary text-white w-100">
                        Delete Notebook
                    </div>
                    <!-- Delete Notebook Alert -->
                    <ng-template #delete_notebook_modal let-modal>
                        <div class="modal-header">
                            <h4 class="modal-title">Caution</h4>
                            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss()">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <p>You are about to delete a notebook</p>
                            <p>Are you sure?</p>
                            <div (click)="deleteNotebook(notebook.key)" class="btn btn-secondary">Yes, Delete This Notebook</div>
                            <div (click)="modal.dismiss()" class="btn btn-dark ml-2">No, Keep It</div>
                        </div>
                    </ng-template>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- New Workout Form -->
<ng-template #new_workout_modal let-modal>
    <div class="modal-header">
        <h4 class="modal-title">Add New Workout</h4>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <app-workout-note-form (closeEvent)="modal.dismiss()"></app-workout-note-form>
</ng-template>
